%======================================================================
\chapter{Some Simple Theorems}
%======================================================================

%----------------------------------------------------------------------
\section{Introduction}
%----------------------------------------------------------------------

In this chapter we will declare and prove some very simple theorems about the examples from chapter [~\ref{chap:examples}]. This simple introduction is only meant to give us a feel for how theorems are stated in Coq and how proofs are constructed using Coq \emph{tactics}. 

Propositions are types in Coq whose type is the sort $Prop$. Any term $t$ whose type is a proposition is a proof term or, for short, a proof. A \emph{Hypothesis} is a local declaration $h : P$ where $h$ is an identifier and $P$ is a proposition. An \emph{Axiom} is similar to a hypothesis except it is declared at the global scope and so it is always available. A \emph{Theorem} or \emph{Lemma} is any identifier whose type is a proposition (~\cite{BC04}). Keywords ``Hypothesis'', ``Axiom'' and ``Theorem'' or ``Lemma'' are used in each case respectively. 

To build a proof in Coq the user states the proposition to prove; this is called a goal to be proved or discharge, along with some hypothesis that makes up the local context. The user then uses commands called tactics to manipulate the local context and to decompose the goal into simpler goals. The goal simplification into sub-goals will continue until all the sub-goals are solved.

In listing ~\ref{lst:proofexample} we have declared a theorem called $example1$ and the corresponding proposition $forall x:nat, x < x + 1.$
 
Note that the notation $P : T$ is also used to declare program $P$ has type $T$. This duality of notation is due to Curry-Howard isomorphism which relates the two worlds of type theory and structural logic together. Once the Theorem has been declared Coq displays the proposition to be proved under a horizontal line written --------, and displays the context of local facts and hypothesis, if any, above the horizontal line. At this point one can enter proof mode by using \emph{Proof.} upon which Coq is ready to accept tactics. Entering tactics that can break the stated goal (under the horizontal line) into one or more sub-goals is how one progresses until no goals left at which point Coq responds with ``No more subgoals'' (~\cite{CoqHurry}).

\lstset{language=Coq}
\begin{lstlisting}[frame=single, caption={Proof Example},label={lst:proofexample}]
Theorem example1: forall x:nat, x < x + 1.
\end{lstlisting}

\section{Theorem One}

In listing ~\ref{lst:theoremone} we define a $policySet$ with a $constraint$ such that if $Alice$ has used the policy with $id1$ to justify her printing $a_{1}$ times, she may do so again if $a_{1} < 5$. The agreement $AgreeCan$ simply links the asset $TheReport$ with the subject $Alice$ and the $policySet$ previously defined. 

We capture the fact that $Alice$ has used the policy with $id1$ to justify her printing $2$ times in an environment called $eA1$. Recall that environments are defined to be non-empty lists of $count_equality$ objects (see ~\ref{lst:environmentcoq}). 

We also declare a hypothesis $H$ with the proposition that results from the translation of the agreement (see definition of $trans_agreement$ in listing ~\ref{lst:transagreement}) and the environment. The proposition can be shown in Coq after some clean-up (e.g. replaced 101 by Alice) and using the form $Eval compute$ : $forall x : subject, x = Alice /\ True -> 2 < 5 -> Permitted x Print TheReport$. 

The theorem $One$ that we are going to prove is trivial but nonetheless in English it states that Alice is Permitted to Print TheReport. The proof comes after the command 'Proof.' and ends with 'Qed'. 

\lstset{language=Coq}
\begin{lstlisting}[frame=single, caption={Theorem One},label={lst:theoremone}]

Definition psA1:policySet :=
  PrimitivePolicySet
    TruePrq
    (PrimitivePolicy (Constraint (Count  5)) id1 Print).

Definition AgreeCan := Agreement (Single Alice) TheReport psA1.

Definition eA1 : environment := 
  (SingleEnv (make_count_equality Alice id1 2)).

Hypothesis H: trans_agreement eA1 AgreeCan.

Theorem One: Permitted Alice Print TheReport.

Proof. simpl in H. apply H. split. reflexivity. auto.  omega. Qed.


\end{lstlisting}






